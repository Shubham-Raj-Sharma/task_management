{% extends "tasks/base.html" %}

{% block title %}Dashboard - Task Manager{% endblock %}

{% block content %}
<div class="card">
    <h2>Welcome, {{ user.first_name|default:user.username }}!</h2>
    <p>Here's your task management overview.</p>
</div>

<div class="grid">
    <div class="card">
        <h3>ğŸ“Œ My Tasks</h3>
        <p style="font-size: 2rem; color: #3498db; margin: 1rem 0;">{{ my_tasks.count }}</p>
        <a href="{% url 'task-list' %}" class="btn">View All Tasks</a>
    </div>
    
    <div class="card">
        <h3>â° In Progress</h3>
        <p style="font-size: 2rem; color: #f39c12; margin: 1rem 0;">{{ in_progress_tasks.count }}</p>
        <a href="{% url 'task-list' %}?status=in_progress" class="btn">View In Progress</a>
    </div>
    
    <div class="card">
        <h3>âš ï¸ Overdue</h3>
        <p style="font-size: 2rem; color: #e74c3c; margin: 1rem 0;">{{ overdue_tasks.count }}</p>
        <a href="{% url 'task-list' %}" class="btn btn-danger">View Overdue</a>
    </div>
    
    <div class="card">
        <h3>ğŸ“‚ Projects</h3>
        <p style="font-size: 2rem; color: #27ae60; margin: 1rem 0;">{{ my_projects.count }}</p>
        <a href="{% url 'project-list' %}" class="btn">View All Projects</a>
    </div>
</div>

<div class="grid">
    <div class="card">
        <h3>ğŸ”¥ Recent Tasks</h3>
        {% if my_tasks %}
            <table>
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Status</th>
                        <th>Due Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for task in my_tasks|slice:":5" %}
                        <tr>
                            <td><a href="{% url 'task-detail' task.id %}">{{ task.title }}</a></td>
                            <td><span class="status-badge status-{{ task.status }}">{{ task.get_status_display }}</span></td>
                            <td>{{ task.due_date|date:"M d, Y"|default:"No date" }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No tasks assigned to you yet.</p>
        {% endif %}
    </div>
    
    <div class="card">
        <h3>ğŸ“Š Projects Overview</h3>
        {% if my_projects %}
            {% for project in my_projects|slice:":3" %}
                <div style="margin: 1rem 0;">
                    <h4>{{ project.name }}</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ project.get_progress }}%;"></div>
                    </div>
                    <small>{{ project.get_progress }}% Complete - {{ project.tasks.count }} tasks</small>
                </div>
            {% endfor %}
        {% else %}
            <p>No projects yet. <a href="{% url 'project-create' %}">Create one</a></p>
        {% endif %}
    </div>
</div>

<div class="card">
    <h3>ğŸ‘¥ Teams</h3>
    {% if my_teams %}
        <div class="grid">
            {% for team in my_teams %}
                <div style="background-color: #f8f9fa; padding: 1rem; border-radius: 4px;">
                    <h4>{{ team.name }}</h4>
                    <p><strong>Members:</strong> {{ team.members.count }}</p>
                    <p><strong>Projects:</strong> {{ team.projects.count }}</p>
                    <a href="{% url 'team-detail' team.id %}" class="btn" style="width: 100%; text-align: center;">View Team</a>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>You're not part of any team yet. <a href="{% url 'team-create' %}">Create a team</a></p>
    {% endif %}
</div>

<div class="card" style="text-align: center;">
    <h3>Quick Actions</h3>
    <a href="{% url 'task-create' %}" class="btn">â• Create Task</a>
    <a href="{% url 'project-create' %}" class="btn">ğŸ“‚ New Project</a>
    <a href="{% url 'team-create' %}" class="btn">ğŸ‘¥ New Team</a>
</div>
{% endblock %}
